<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'>
<sqlMap namespace="result">

<typeAlias alias="investDto" type="product.bean.InvestDto"/>
<typeAlias alias="messageDto" type="result.bean.MessageDto"/>
<typeAlias alias="registerDto" type="product.bean.RegisterDto"/>
<typeAlias alias="settingDto" type="setting.bean.SettingDto"/>

<select id="getmessage" resultClass="messageDto" parameterClass="int">
	select * from message where m_memno=#no# order by m_time desc
</select>

<select id="in_history" resultClass="investDto" parameterClass="int">
	select * from invest where i_memnum = #no#
</select> 

<select id="investcheck" resultClass="int" parameterClass="java.util.Map">
	select count(*) from invest where i_memnum=#no# and i_pcode=#p_code#
</select>

<!-- manager로 옮기기 -->
<select id="investcount" resultClass="int">
	select count(*) from invest
</select>

<select id="investpcode" resultClass="String">
	select i_pcode from invest
</select>

<select id="investway" resultClass="int" parameterClass="String">
	select count(i_way) from invest where i_way=#i_way#
</select>

<select id="investage" resultClass="String">
	select m.birth from memberinfo m, invest i where m.no = i.i_memnum
</select>

<select id="investgender" resultClass="String">
	select m.gender from memberinfo m, invest i where m.no = i.i_memnum
</select>

<!-- 여기까지 -->

<select id="alarm" resultClass="int" parameterClass="int">
	select count(m_check) from message where m_memno=#no# and m_check=1
</select>

<update id="completefund" parameterClass="registerDto">
	update product set p_success=#p_success# where p_code=#p_code#
</update>

<update id="readed" parameterClass="int">
	update message set m_check=0 where m_memno=#no#
</update>



</sqlMap>